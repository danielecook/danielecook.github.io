<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

  <title>A function for retrieving SNP data from Entrez using BioPython - Daniel E. Cook</title>
  <meta content='A function for retrieving SNP data from Entrez using BioPython - Daniel E. Cook' property='title' />
  <meta content='A function for retrieving SNP data from Entrez using BioPython - Daniel E. Cook' property='og:title' />


<meta property="og:description" content="Biopython is a great tool for interacting with biological databases. I use it to retrieve records from NCBI’s Entrez databases including Pubmed.
Unfortunately – one notable database biopython has trouble working with is the SNP database. This is due to the Bio.Entrez parser being unable to handle the XML returned from this database. One solution is to use a built in Python XML parser, but I thought I’d try to come up with an easier solution." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.danielecook.com/a-function-for-retrieving-snp-data-from-entrez-using-biopython/" />


<meta property="article:published_time" content="2013-06-06T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2013-06-06T00:00:00&#43;00:00"/>








<meta name="generator" content="Hugo 0.62.2" />

<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #309fff; 
  --secondary-color: #ff622e;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
  --max-width: 850px;
}</style>
<link href='https://www.danielecook.com/css/tachyons.min.min.css' integrity="" rel="stylesheet" media="screen">
<link href='https://www.danielecook.com/css/styles.min.css' integrity="" rel="stylesheet" media="screen">
<link href='https://www.danielecook.com/css/syntax.min.css' integrity="" rel="stylesheet" media="screen">


<link rel="icon" 
 
  href='/favicon.ico'

type="image/x-icon"/>

<link rel="alternate" type="application/rss+xml" href="https://www.danielecook.com/a-function-for-retrieving-snp-data-from-entrez-using-biopython/feed/index.xml" title="Daniel E. Cook" />
</head>
<body class="global-font">
  <div id="nav" class="content-width center">
<nav class="flex-ns justify-between border-box pa3 pl3-l pr2-l mt1 mt0-ns" id="navbar">
  <div class="flex">
    <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph2 br2" id="site-title" href='/' title="Home">Daniel E. Cook</a>
  </div>
  
  <div class=" flex-ns mt2 mt0-ns pv1">
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/about/' title="about">about</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/' title="blog">blog</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/photos/' title="photos">photos</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/projects/' title="projects">projects</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/contact/' title="contact">contact</a>
    
  </div>
  
</nav>
</div>

  
<main class="center mv4 content-width ph3">
  <div class="f2 fw6 heading-color heading-font post-title">A function for retrieving SNP data from Entrez using BioPython</div>
  
  <p class="silver f6 mt1 mb4 post-meta">
    <time>2013-06-06</time> 
     
    
    &nbsp;&nbsp;<a href='/tags/gist' class="link silver tag">gist</a> &nbsp;&nbsp; 
    
  </p>
  
  <div class="lh-copy post-content"><p><a href="http://biopython.org/">Biopython</a> is a great tool for interacting with biological databases. I use it to retrieve records from <a href="http://www.ncbi.nlm.nih.gov/About/tools/restable_mol.html">NCBI’s Entrez databases</a> including Pubmed.</p>
<p>Unfortunately – one notable database biopython has trouble working with is the <a href="http://www.ncbi.nlm.nih.gov/snp">SNP</a> database. This is due to the <code>Bio.Entrez</code> parser being unable to handle the XML returned from this database. One solution is to use a built in Python XML parser, but I thought I’d try to come up with an easier solution.</p>
<p>To solve this problem – I wrote a function for retrieving SNP data, and parsing it into an array.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span> <span class="k">as</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">Entrez</span>

<span class="n">Entrez</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="sa"></span><span class="s2">&#34;</span><span class="s2">YOUR@EMAIL.HERE</span><span class="s2">&#34;</span>

<span class="k">def</span> <span class="nf">pull_line</span><span class="p">(</span><span class="n">var_set</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span><span class="p">:</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;</span><span class="s2">
</span><span class="s2"></span><span class="s2">    This function parses data from lines in one of three ways:</span><span class="s2">
</span><span class="s2"></span><span class="s2">    1.) Pulls variables out of a particular line when defined as </span><span class="s2">&#34;</span><span class="s2">variablename=[value]</span><span class="s2">&#34;</span><span class="s2"> - uses a string to find the variable.</span><span class="s2">
</span><span class="s2"></span><span class="s2">    2.) Pulls variables based on a set position within a line [splits the line by </span><span class="s2">&#39;</span><span class="s2">|</span><span class="s2">&#39;</span><span class="s2">]</span><span class="s2">
</span><span class="s2"></span><span class="s2">    3.) Defines variables that can be identified based on a limited possible set of values - [categorical variable, specified using an array]</span><span class="s2">
</span><span class="s2"></span><span class="s2">    </span><span class="s2">&#34;&#34;&#34;</span>
    <span class="n">line_set</span> <span class="o">=</span> <span class="p">{</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">var_set</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="p">)</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line_set</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="p">]</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line_set</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line_set</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="k">return</span> <span class="n">line_set</span>

<span class="k">def</span> <span class="nf">pull_vars</span><span class="p">(</span><span class="n">var_set</span><span class="p">,</span><span class="n">line_start</span><span class="p">,</span><span class="n">line</span><span class="p">,</span><span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="p">:</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;</span><span class="s2">
</span><span class="s2"></span><span class="s2">    Delegates and compiles data from entrez flat files dependent on whether</span><span class="s2">
</span><span class="s2"></span><span class="s2">    the type of data trying to be pulled is contained in unique vs. non-unique lines.</span><span class="s2">
</span><span class="s2"></span><span class="s2">    For example - the first line of the flat file is always something like this:</span><span class="s2">
</span><span class="s2"></span><span class="s2">    rs12009 | Homo Sapiens | 9606 | etc.</span><span class="s2">
</span><span class="s2"></span><span class="s2">    This line is unique (refers to RefSnp identifier)- and only occurs once in each flat file. On the other hand, lines</span><span class="s2">
</span><span class="s2"></span><span class="s2">    beginning with </span><span class="s2">&#34;</span><span class="s2">ss[number]</span><span class="s2">&#34;</span><span class="s2"> refer to </span><span class="s2">&#39;</span><span class="s2">submitted snp</span><span class="s2">&#39;</span><span class="s2"> numbers and can appear multiple times.</span><span class="s2">
</span><span class="s2"></span><span class="s2">    </span><span class="s2">&#34;&#34;&#34;</span>
    <span class="n">lineset</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1"> | </span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">line_start</span><span class="p">)</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lineset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> 
    <span class="c1"># If the same line exists multiple times - place results into an array</span>
    <span class="k">if</span> <span class="n">multi</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">pulled_vars</span> <span class="o">=</span> <span class="p">[</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lineset</span><span class="p">:</span>
            <span class="c1"># Pull date in from line and append</span>
            <span class="n">pulled_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pull_line</span><span class="p">(</span><span class="n">var_set</span><span class="p">,</span><span class="n">line</span><span class="p">)</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pulled_vars</span>  
    <span class="k">else</span><span class="p">:</span>
    <span class="c1"># Else if the line is always unique, output single dictionary</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">lineset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pulled_vars</span> <span class="o">=</span> <span class="p">{</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">pull_line</span><span class="p">(</span><span class="n">var_set</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_snp</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="p">:</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;</span><span class="s2"> </span><span class="s2">
</span><span class="s2"></span><span class="s2">    Takes as input an array of snp identifiers and returns </span><span class="s2">
</span><span class="s2"></span><span class="s2">    a parsed dictionary of their data from Entrez.</span><span class="s2">
</span><span class="s2"></span><span class="s2">    </span><span class="s2">&#34;&#34;&#34;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Entrez</span><span class="o">.</span><span class="n">efetch</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">SNP</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">,</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="p">,</span> <span class="n">rettype</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">flt</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">retmode</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">flt</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="p">}</span> <span class="c1"># Return dictionary variable</span>
    <span class="c1"># Parse flat file response</span>
    <span class="k">for</span> <span class="n">snp_info</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="n">response</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa"></span><span class="s1">&#39;</span><span class="se">\n</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">snp_info</span>
        <span class="c1"># Parse the First Line. Details of rs flat files available here:</span>
        <span class="c1"># ftp://ftp.ncbi.nlm.nih.gov/snp/specs/00readme.txt</span>
        <span class="n">snp</span> <span class="o">=</span> <span class="n">snp_info</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa"></span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Parse the &#39;rs&#39; line:</span>
        <span class="n">rsId</span> <span class="o">=</span> <span class="n">snp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2"> | </span><span class="s2">&#34;</span><span class="p">)</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="p">}</span>

        <span class="c1"># rs vars</span>
        <span class="n">rs_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">organism</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">taxId</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">snpClass</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">genotype</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">genotype=</span><span class="s2">&#34;</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">rsLinkout</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">submitterlink=</span><span class="s2">&#34;</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">date</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">updated </span><span class="s2">&#34;</span><span class="p">}</span>

        <span class="c1"># rs vars</span>
        <span class="n">ss_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ssId</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">handle</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">locSnpId</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient=</span><span class="s2">&#34;</span><span class="p">,</span>
                   <span class="sa"></span><span class="s2">&#34;</span><span class="s2">exemplar</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ss_pick=</span><span class="s2">&#34;</span><span class="p">,</span>
                   <span class="p">}</span>

        <span class="c1"># SNP line variables:</span>
        <span class="n">SNP_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">observed</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">alleles=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">value</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">het=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">stdError</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">se(het)=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">validated</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">validated=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">validProbMin</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">min_prob=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">validProbMax</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">max_prob=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">validation</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">suspect=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">AlleleOrigin</span><span class="s2">&#34;</span><span class="p">:</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">unknown</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">germline</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">somatic</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">inherited</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">paternal</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">maternal</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">de-novo</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">bipaternal</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">unipaternal</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">not-tested</span><span class="s1">&#39;</span><span class="p">,</span>
                                    <span class="sa"></span><span class="s1">&#39;</span><span class="s1">tested-inconclusive</span><span class="s1">&#39;</span><span class="p">]</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">snpType</span><span class="s2">&#34;</span><span class="p">:</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">notwithdrawn</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">artifact</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">gene-duplication</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">duplicate-submission</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">notspecified</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">ambiguous-location;</span><span class="s1">&#39;</span><span class="p">,</span>
                               <span class="sa"></span><span class="s1">&#39;</span><span class="s1">low-map-quality</span><span class="s1">&#39;</span><span class="p">]</span><span class="p">}</span>
        
        <span class="c1"># CLINSIG line variables:</span>
        <span class="n">CLINSIG_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ClinicalSignificance</span><span class="s2">&#34;</span><span class="p">:</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">probable-pathogenic</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">pathogenic</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">other</span><span class="s1">&#39;</span><span class="p">]</span><span class="p">}</span>

        <span class="c1"># GMAF line variables</span>
        <span class="n">GMAF_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">allele</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">allele=</span><span class="s2">&#34;</span><span class="p">,</span>
                     <span class="sa"></span><span class="s2">&#34;</span><span class="s2">sampleSize</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">count=</span><span class="s2">&#34;</span><span class="p">,</span>
                     <span class="sa"></span><span class="s2">&#34;</span><span class="s2">freq</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">MAF=</span><span class="s2">&#34;</span><span class="p">}</span>

        <span class="c1"># CTG line variables</span>
        <span class="n">CTG_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">groupLabel</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">assembly=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">chromosome</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">chr=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">physmapInt</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">chr-pos=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">asnFrom</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ctg-start=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">asnTo</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ctg-end=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">loctype</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">loctype=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient=</span><span class="s2">&#34;</span><span class="p">}</span>

        <span class="c1"># LOC line variables</span>
        <span class="n">LOC_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">symbol</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">geneId</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">locus_id=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">fxnClass</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">fxn-class=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">allele</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">allele=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">readingFrame</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">frame=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">residue</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">residue=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">aaPosition</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">aa_position=</span><span class="s2">&#34;</span><span class="p">}</span>

        <span class="c1"># LOC line variables</span>
        <span class="n">SEQ_vars</span> <span class="o">=</span> <span class="p">{</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">gi</span><span class="s2">&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">source</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">source-db=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">asnFrom</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">seq-pos=</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient</span><span class="s2">&#34;</span><span class="p">:</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">orient=</span><span class="s2">&#34;</span><span class="p">}</span>

        <span class="c1"># Pull out variable information:</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">rs</span><span class="s1">&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">rs_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">rs</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">ss</span><span class="s1">&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">ss_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">ss</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">SNP</span><span class="s1">&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">SNP_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">SNP</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">CLINSIG</span><span class="s1">&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">CLINSIG_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">CLINSIG</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">GMAF</span><span class="s1">&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">GMAF_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">GMAF</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">CTG</span><span class="s1">&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">CTG_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">CTG</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">LOC</span><span class="s1">&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">LOC_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">LOC</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">r</span><span class="p">[</span><span class="n">rsId</span><span class="p">]</span><span class="p">[</span><span class="sa"></span><span class="s1">&#39;</span><span class="s1">SEQ</span><span class="s1">&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pull_vars</span><span class="p">(</span><span class="n">SEQ_vars</span><span class="p">,</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">SEQ</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">snp</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>
        

<span class="n">snp</span> <span class="o">=</span> <span class="n">get_snp</span><span class="p">(</span><span class="p">[</span><span class="sa"></span><span class="s2">&#34;</span><span class="s2">12009</span><span class="s2">&#34;</span><span class="p">]</span><span class="p">)</span>
<span class="k">print</span> <span class="n">pp</span><span class="p">(</span><span class="n">snp</span><span class="p">)</span>
</code></pre></div></div>
  
        <div id='comments'></div>
  
</main>

   









<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2 next_prev">
  ← <a href="https://www.danielecook.com/create-new-file-in-finder-with-alfred-2/">prev post</a>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <a href="https://www.danielecook.com/accessing-the-ucsc-genome-browser-mysql-database/">next post</a> →
  </p>
</div>



  <div class='cb'></div>
<footer class="content-width mt3 mb4 f6 center ph3 gray tc tl-l">
    <a href="http://creativecommons.org/licenses/by/3.0/deed.en_US" class='cc'>CC</a>
    <br /><br />
</footer>
  






<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;


  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}







</script>





  <script src='https://www.danielecook.com/js/instantclick.js' integrity="" data-no-instant></script>
    <script data-no-instant>

    function utterances(index) {
        var discussion = document.getElementById('comments');
        if (!discussion) {
            return;
        }
        var script = document.createElement('script');
        script.src = 'https://utteranc.es/client.js';
        script.setAttribute('repo', 'danielecook/danielecook.com');
        script.setAttribute('issue-term', index);
        script.setAttribute('theme', 'github-light');
        script.setAttribute('crossorigin', 'anonymous');
        discussion.appendChild(script);
    }

    InstantClick.on('change', function() {
        utterances(location.pathname + location.search)
    });


    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-39176354-1', 'auto');

        InstantClick.on('change', function() {
            ga('send', 'pageview', location.pathname + location.search);
      });
       

    InstantClick.init();
    </script>
</body>
</html>