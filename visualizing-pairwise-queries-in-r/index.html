<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

  <title>Visualizing Pairwise Queries in R - Daniel E. Cook</title>
  <meta content='Visualizing Pairwise Queries in R - Daniel E. Cook' property='title' />
  <meta content='Visualizing Pairwise Queries in R - Daniel E. Cook' property='og:title' />


<meta property="og:description" content="You can look for interesting associations between sets of search terms on PubMed by comparing how often two terms co-occur. The code below returns the number of publications where both terms are mentioned, acting as a rough estimate for how associated they are (at least, in the scholarly world).
In the example below, I show the results from organisms x diseases/disease-associated terms which is an imperfect look at how various terms estimate of how much each disease is studied in a given organism." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.danielecook.com/visualizing-pairwise-queries-in-r/" />


<meta property="article:published_time" content="2014-08-02T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2014-08-02T00:00:00&#43;00:00"/>








<meta name="generator" content="Hugo 0.62.2" />

<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #309fff; 
  --secondary-color: #ff622e;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
  --max-width: 850px;
}</style>
<link href='https://www.danielecook.com/css/tachyons.min.min.css' integrity="" rel="stylesheet" media="screen">
<link href='https://www.danielecook.com/css/styles.min.css' integrity="" rel="stylesheet" media="screen">
<link href='https://www.danielecook.com/css/syntax.min.css' integrity="" rel="stylesheet" media="screen">


<link rel="icon" 
 
  href='/favicon.ico'

type="image/x-icon"/>

<link rel="alternate" type="application/rss+xml" href="https://www.danielecook.com/visualizing-pairwise-queries-in-r/feed/index.xml" title="Daniel E. Cook" />
</head>
<body class="global-font">
  <div id="nav" class="content-width center">
<nav class="flex-ns justify-between border-box pa3 pl3-l pr2-l mt1 mt0-ns" id="navbar">
  <div class="flex">
    <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph2 br2" id="site-title" href='/' title="Home">Daniel E. Cook</a>
  </div>
  
  <div class=" flex-ns mt2 mt0-ns pv1">
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/about/' title="about">about</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/' title="blog">blog</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/photos/' title="photos">photos</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/projects/' title="projects">projects</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='/contact/' title="contact">contact</a>
    
  </div>
  
</nav>
</div>

  
<main class="center mv4 content-width ph3">
  <div class="f2 fw6 heading-color heading-font post-title">Visualizing Pairwise Queries in R</div>
  
  <p class="silver f6 mt1 mb4 post-meta">
    <time>2014-08-02</time> 
     
    
    &nbsp;&nbsp;<a href='/tags/gist' class="link silver tag">gist</a> &nbsp;&nbsp;<a href='/tags/pubmed' class="link silver tag">pubmed</a> &nbsp;&nbsp; 
    
  </p>
  
  <div class="lh-copy post-content"><p><!-- raw HTML omitted --></p>
<p>You can look for interesting associations between sets of search terms on PubMed by comparing how often two terms co-occur. The code below returns the number of publications where both terms are mentioned, acting as a rough estimate for how associated they are (at least, in the scholarly world).</p>
<p>In the example below, I show the results from organisms x diseases/disease-associated terms which is an imperfect look at how various terms estimate of how much each disease is studied in a given organism. Of course, this should all be taken with a (big) grain of salt because these organisms and diseases have many synonyms or related terms (e.g. <em>M. Musculus</em> is often referred to as Mouse in the literature). Additionally, the result count is based off of whether or not the terms were found together within the title and abstract of the literature only – and not the body of the text in many cases.</p>
<div class="highlight"><pre class="chroma"><code class="language-R" data-lang="R"><span class="c1"># install.packages(&#34;RISmed&#34;, &#34;ggplot2&#34;)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">RISmed</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Given two lists of terms, lets see how &#39;hot&#39; they are together</span>
<span class="n">set1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;</span><span class="s">ebola&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">autoimmune&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">Diabetes&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">Glioblastoma&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">Asthma&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">Schizophrenia&#34;</span><span class="p">)</span>
<span class="n">set2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;</span><span class="s">C. elegans&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">D. Melanogaster&#34;</span><span class="p">,</span> <span class="s">&#34;</span><span class="s">M. Musculus&#34;</span><span class="p">,</span><span class="s">&#34;</span><span class="s">S. Cerevisiae&#34;</span><span class="p">)</span>

<span class="c1"># Generate all possible pairs</span>
<span class="n">pairs</span> <span class="o">&lt;-</span> <span class="nf">expand.grid</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>

<span class="c1"># Search pubmed for each pair, and return the number of search results.</span>
<span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span><span class="p">,</span>  <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">query</span> <span class="o">&lt;-</span> <span class="nf">sprintf</span><span class="p">(</span><span class="s">&#34;</span><span class="s">%s %s&#34;</span><span class="p">,</span> <span class="n">pairs</span><span class="n">[x</span><span class="p">,</span><span class="n">]</span><span class="o">$</span><span class="n">Var1</span><span class="p">,</span> <span class="n">pairs</span><span class="n">[x</span><span class="p">,</span><span class="n">]</span><span class="o">$</span><span class="n">Var2</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">&lt;-</span> <span class="nf">EUtilsSummary</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;</span><span class="s">esearch&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s">&#39;</span><span class="s">pubmed&#39;</span><span class="p">)</span>
  <span class="nf">c</span><span class="p">(</span><span class="n">q1</span><span class="o">=</span><span class="n">pairs</span><span class="n">[x</span><span class="p">,</span><span class="n">]</span><span class="o">$</span><span class="n">Var1</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="n">pairs</span><span class="n">[x</span><span class="p">,</span><span class="n">]</span><span class="o">$</span><span class="n">Var2</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="nf">QueryCount</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="p">)</span>
<span class="p">}</span><span class="p">)</span>

<span class="c1"># Do some data formatting on the results.</span>
<span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">do.call</span><span class="p">(</span><span class="s">&#34;</span><span class="s">rbind&#34;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="c1"># Turn the number of search results into numeric form.</span>
<span class="n">results</span><span class="o">$</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">results</span><span class="o">$</span><span class="n">count</span><span class="p">)</span>

<span class="c1"># Plot the results using geom_tile</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_tile</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">q2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">count</span><span class="p">)</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">q2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">count</span><span class="p">)</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;</span><span class="s">white&#34;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#34;</span><span class="s">Disease Publications by Organism&#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">&#34;</span><span class="s">x&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;</span><span class="s">y&#34;</span><span class="p">)</span>

<span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;</span><span class="s">~/Desktop/pairwise_search.png&#34;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">6</span><span class="p">)</span>

</code></pre></div></div>
  
        <div id='comments'></div>
  
</main>

   









<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2 next_prev">
  ← <a href="https://www.danielecook.com/a-short-tour-around-lake-michigan/">prev post</a>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <a href="https://www.danielecook.com/generate-fasta-sequence-lengths/">next post</a> →
  </p>
</div>



  <div class='cb'></div>
<footer class="content-width mt3 mb4 f6 center ph3 gray tc tl-l">
    <a href="http://creativecommons.org/licenses/by/3.0/deed.en_US" class='cc'>CC</a>
    <br /><br />
</footer>
  






<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;


  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}







</script>





  <script src='https://www.danielecook.com/js/instantclick.js' integrity="" data-no-instant></script>
    <script data-no-instant>

    function utterances(index) {
        var discussion = document.getElementById('comments');
        if (!discussion) {
            return;
        }
        var script = document.createElement('script');
        script.src = 'https://utteranc.es/client.js';
        script.setAttribute('repo', 'danielecook/danielecook.com');
        script.setAttribute('issue-term', index);
        script.setAttribute('theme', 'github-light');
        script.setAttribute('crossorigin', 'anonymous');
        discussion.appendChild(script);
    }

    InstantClick.on('change', function() {
        utterances(location.pathname + location.search)
    });


    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-39176354-1', 'auto');

        InstantClick.on('change', function() {
            ga('send', 'pageview', location.pathname + location.search);
      });
       

    InstantClick.init();
    </script>
</body>
</html>